---
title: 新技能-画蛋白结构图并标注
categories: Bioinfomatic
date: 2020-02-08 15:29:01
tags: ['pymol', 'swiss-model']
---

果然我这种工作总是得学一些杂七杂八的新东西... 今天的新技能是使用PyMol画肽段结构的展示图.
<!-- 摘要部分 -->
<!-- more -->

主要任务是这样的: 现在有若干表位, 需要展示这个表位在完整的蛋白结构上是什么位置, 所以需要一个3D的蛋白结构图, 然后在上面把相关的蛋白表位标记出来.

使用的软件/服务为Swiss-Model和PyMol的开源版本, 前者是预测蛋白结构的, 后者是根据前者的蛋白结构结果进行成图和标注的.

实际工作的内容当然不方便在此展示, 所以我使用研究者生期间做的星状病毒作例子.

首先是上NCBI去查询一个星状病毒的序列, 我选了[编号为NC_001943的人星状病毒全序列](https://www.ncbi.nlm.nih.gov/nuccore/NC_001943.1), 从中获取它4373-6733这一区段的CDS编码的*capsid precursor protein*的序列, 直接贴到Swiss-Model的输入框, 搜索同源模型后进行结构预测.

预测完成后将所有预测结果下载, 这样就有蛋白质结构了. 接下来真是用PyMol成图和标注了.

PyMol正在Arch的默认源里就有, `sudo pacman -S pymol`就能安装, 直接打开用就行.

首先将之前获取的文件进行解压缩, 然后找到里面特定模型的`pdb`文件, 使用PyMol打开(`File -> Open`), 就可以看到软件里出现蛋白的3D模型图了. 

接下来是标注, 虽然软件可以通过鼠标操作, 但是考虑到如果需要操作的部分太多, 用鼠标很繁琐,  所以还是记录在`>PyMol`后面输入命令如何操作. 主要的部分就是选中和标注这两个步骤:

```pymol
select dis, resi 100-150    
show spheres, dis
```

基本上没有特殊要求的话, 到这里就可以把蛋白用鼠标转到个好一点的角度然后导出图片了, 如果本身3D图的结构有点复杂, 选择的表位在比较里面, 怎么转都不好看的话, 可以考虑通过设置将未选中位置的颜色进行变更:`Setting -> Transparency -> Cartoon -> 80%`, 这样依赖默认显示的Cartoon图形就会变为透明, 而选中的100-150的氨基酸应为显示的是spheres(球体), 依然会是实心的, 就可以很好的与背景区分开来了.

附过程图一张.

![astro_model](https://raw.githubusercontent.com/SilenWang/Gallary/master/astro_model)

以上