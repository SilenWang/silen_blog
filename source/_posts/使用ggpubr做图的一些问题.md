---
title: R绘图问题记录
categories: Script
date: 2022-03-13 03:12:07
tags: ['R', 'ggplot', 'ggpubr', 'survminer']
---

前段时间帮同事做图, 又解锁了一些新的问题和解决方式, 涉及ggpubr, 生存分析包, 做个记录.

<!-- 摘要部分 -->
<!-- more -->

## survminer绘制出图形的保存问题

`survminer`中包含一个很方便的函数`ggsurvplot`, 使用该函数可很方便的绘制生存曲线并加上分组的显著性检验, 还能在图形下方加上频数表.

但是这个函数跟一般的`ggplot`系函数的返回并不同, 他返回的并不是一个`ggplot()`对象, 而是`ggsurvplot`对象, 这个对象中包含`survObj$plot`为生存图形本地, `survObj$table`为频数表图形. 所以如果需要自己使用ggplot的一些语法对图形进行调整修饰的话, 应该对这两个对象内包含的对象进行操作.

## ggpubr至今存在分面图显著性检验标注bug

截止到去年12月, `ggpubr`的箱线图(其他未测试, 可能也有)的在分面后附加显著性检验时, 依然存在一定bug, 包括分面后数据不正确, 显著性检验标注位置不正确. 需要手动绘制单个图形然后把他们组合起来

## 图内表格标注

挖坑待补充

## 多种显著性标注实现方式

由于某次甲方的图形提出了比较麻烦的要求, 即进行显著性检验的时候, 以某组作为参考进行, 然后这个某组, 有两个而不是一个, 因此`ggpubr`本身自带的函数无法满足需求, 我花了好大功夫查找如何手动进行绘制, 不同要求对应的不同实现方法记录在此:

挖坑待补充